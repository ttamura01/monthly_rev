geom_smooth(method = "lm", se = FALSE) +
scale_color_manual(breaks = c("Adelie", "Chinstrap", "Gentoo"),
values = c("blue", "red", "yellow")) +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm,
group = species,
colour = species)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
scale_color_manual(breaks = c("Adelie", "Chinstrap", "Gentoo"),
values = c("blue", "red", "green")) +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm,
group = species,
colour = species)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
# scale_color_manual(breaks = c("Adelie", "Chinstrap", "Gentoo"),
#                    values = c("blue", "red", "green")) +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm,
group = species,
colour = species)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
scale_color_manual(breaks = c("Adelie", "Chinstrap", "Gentoo"),
values = c("blue", "red", "green")) +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm,
group = species,
colour = species)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
scale_color_brewer(palette = "Dark2")) +
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm,
group = species,
colour = species)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
scale_color_brewer(palette = "Dark2") +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g)) +
geom_histogram()
penguins %>%
ggplot(aes(x = species)) +
geom_bar()
penguins %>%
ggplot(aes(x = species)) +
geom_bar(color = "species")
penguins %>%
ggplot(aes(x = species)) +
geom_bar(color = "steelblue")
penguins %>%
ggplot(aes(x = species)) +
geom_bar(fill = "steelblue")
penguins %>%
ggplot(aes(x = species)) +
geom_bar(fill = "steelblue",
color = "black")
ggplot(penguins, aes(x = species,
y = body_mass_g)) +
geom_boxplot()
ggplot(penguins, aes(x = species,
y = body_mass_g,
fill = species)) +
geom_boxplot()
ggplot(penguins, aes(x = species,
y = body_mass_g)) +
geom_boxplot()
ggplot(penguins, aes(x = species,
y = body_mass_g)) +
geom_boxplot() +
coord_flip()
ggplot(crickets,
aes(x = temp,
y = rate,
colour = species)) +
geom_jitter(shape = 4,
stroke = 2) +
geom_smooth(method = "lm", se = F) +
labs(x = "Temperature (C)",
y = "Chirp rate",
color = "Species") +
scale_color_brewer(palette = "Dark2") +
theme(
plot.background = element_rect(fill = "#E1E1D3"),
panel.background = element_rect(fill = "#e1e1d3"),
legend.background = element_rect(fill = "#e1e1d3")
)
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm)) +
geom_point() +
geom_smooth()
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm)) +
geom_point(colour = "steelblue") +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm,
group = species,
colour = species)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
scale_color_manual(breaks = c("Adelie", "Chinstrap", "Gentoo"),
values = c("blue", "red", "green")) +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g,
y = bill_length_mm,
group = species,
colour = species)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
scale_color_brewer(palette = "Dark2") +
labs(x = "Body mass (g)",
y = "Bill length (mm)",
title = "Antarctic penguins",
caption = "Source: Gorman, Williams, and Fraser") +
theme_minimal()
penguins %>%
ggplot(aes(x = body_mass_g)) +
geom_histogram()
penguins %>%
ggplot(aes(x = species)) +
geom_bar(fill = "steelblue",
color = "black")
ggplot(penguins, aes(x = species,
y = body_mass_g)) +
geom_boxplot()
ggplot(penguins, aes(x = species,
y = body_mass_g,
colour = species)) +
geom_boxplot()
ggplot(penguins, aes(x = species,
y = body_mass_g,
fill = species)) +
geom_boxplot() +
coord_flip()
rm(list = ls())
library(tidyverse)
library(dplyr)
library(ggtext)
library(scales)
library(glue)
setwd("/Users/takayukitamura/Documents/R_Computing/monthly_rev")
getwd()
ds <- read.csv("realtor_monthly.csv", header = TRUE)
tail(ds)
ds <- read.csv("realtor_monthly.csv", header = TRUE) %>%
select(-X)
ds
write.csv(ds,"realtor_monthly.csv")
read.csv("realtor_monthly.csv", header = TRUE)
ds <- read.csv("realtor_monthly.csv", header = TRUE) %>%
select(-X)
sapply(ds, class)
ds$date <- as.Date(ds$date, format = "%Y-%m-%d")
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_col()
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_point()
ds %>%
ggplot(aes(x = realtors, y = revenue)) +
geom_point() +
geom_smooth(method = "lm")
model <- lm(revenue ~ realtors, ds)
coef(model)
summary(model)
plot(model)
r2 <- summary(model)$r.squared
r2_rounded <- round(r2, 2)
intercept <- format(model$coefficients[1], digits = 7)
slope <- format(model$coefficients[2], digits = 4)
formula <- glue("y={slope}X + {intercept}\n R^2 = {r2_rounded}")
formula
monthly <- ds %>%
mutate(
residuals = residuals(model),
std_redisuals = residuals/sd(residuals(model))
)
ggplot(monthly, aes(x = realtors, y = revenue)) +
geom_point(aes(color = std_redisuals), size = 3) +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
annotate(geom = "text",
x = 75,
y = 9000,
label = formula ) +
scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
scale_y_continuous(breaks = seq(5000, 12500, 2500),
labels = scales::label_comma()) +
theme_minimal() +
labs(
title = "Monthly revenue vs. Number of Realtors",
subtitle = "Points colored by standardized residuals",
x = "# of Realtors with Business",
y = "Monthly Revenue",
color = "Standardized Residuals"
) +
theme(
plot.title = element_text(size = 16, face = "bold")
)
ggplot(monthly, aes(x = realtors, y = revenue)) +
geom_point(aes(color = std_redisuals), size = 3) +
geom_smooth(method = "lm", se = T, color = "blue") +
annotate(geom = "text",
x = 75,
y = 9000,
label = formula ) +
scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
scale_y_continuous(breaks = seq(5000, 12500, 2500),
labels = scales::label_comma()) +
theme_minimal() +
labs(
title = "Monthly revenue vs. Number of Realtors",
subtitle = "Points colored by standardized residuals",
x = "# of Realtors with Business",
y = "Monthly Revenue",
color = "Standardized Residuals"
) +
theme(
plot.title = element_text(size = 16, face = "bold")
)
ggplot(monthly, aes(x = realtors, y = revenue)) +
geom_point(aes(color = std_redisuals), size = 3) +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
annotate(geom = "text",
x = 75,
y = 9000,
label = formula ) +
scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
scale_y_continuous(breaks = seq(5000, 12500, 2500),
labels = scales::label_comma()) +
theme_minimal() +
labs(
title = "Monthly revenue vs. Number of Realtors",
subtitle = "Points colored by standardized residuals",
x = "# of Realtors with Business",
y = "Monthly Revenue",
color = "Standardized Residuals"
) +
theme(
plot.title = element_text(size = 16, face = "bold")
)
ds <- ds %>%
filter(date >= as.Date("2025-02-01"))
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_col()
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_point()
ds %>%
ggplot(aes(x = realtors, y = revenue)) +
geom_point() +
geom_smooth(method = "lm")
model <- lm(revenue ~ realtors, ds)
coef(model)
summary(model)
plot(model)
sapply(ds, class)
ds$date <- as.Date(ds$date, format = "%Y-%m-%d")
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_col()
read.csv("realtor_monthly.csv", header = TRUE) %>%
select(-X)
ds <- read.csv("realtor_monthly.csv", header = TRUE) %>%
select(-X)
sapply(ds, class)
ds$date <- as.Date(ds$date, format = "%Y-%m-%d")
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_col()
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_point()
ds %>%
ggplot(aes(x = realtors, y = revenue)) +
geom_point() +
geom_smooth(method = "lm")
model <- lm(revenue ~ realtors, ds)
coef(model)
summary(model)
plot(model)
r2 <- summary(model)$r.squared
r2_rounded <- round(r2, 2)
intercept <- format(model$coefficients[1], digits = 7)
slope <- format(model$coefficients[2], digits = 4)
formula <- glue("y={slope}X + {intercept}\n R^2 = {r2_rounded}")
monthly <- ds %>%
mutate(
residuals = residuals(model),
std_redisuals = residuals/sd(residuals(model))
)
ggplot(monthly, aes(x = realtors, y = revenue)) +
geom_point(aes(color = std_redisuals), size = 3) +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
annotate(geom = "text",
x = 75,
y = 9000,
label = formula ) +
scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
scale_y_continuous(breaks = seq(5000, 12500, 2500),
labels = scales::label_comma()) +
theme_minimal() +
labs(
title = "Monthly revenue vs. Number of Realtors",
subtitle = "Points colored by standardized residuals",
x = "# of Realtors with Business",
y = "Monthly Revenue",
color = "Standardized Residuals"
) +
theme(
plot.title = element_text(size = 16, face = "bold")
)
rm(list = ls())
library(tidyverse)
library(dplyr)
library(ggtext)
library(scales)
library(glue)
setwd("/Users/takayukitamura/Documents/R_Computing/monthly_rev")
getwd()
ds <- read.csv("realtor_monthly.csv", header = TRUE) %>%
select(-X)
ds
sapply(ds, class)
ds$date <- as.Date(ds$date, format = "%Y-%m-%d")
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_col()
ds %>%
ggplot(aes(x = date, y = revenue)) +
geom_point()
ds %>%
ggplot(aes(x = realtors, y = revenue)) +
geom_point() +
geom_smooth(method = "lm")
model <- lm(revenue ~ realtors, ds)
coef(model)
summary(model)
plot(model)
r2 <- summary(model)$r.squared
r2_rounded <- round(r2, 2)
intercept <- format(model$coefficients[1], digits = 7)
slope <- format(model$coefficients[2], digits = 4)
formula <- glue("y={slope}X + {intercept}\n R^2 = {r2_rounded}")
monthly <- ds %>%
mutate(
residuals = residuals(model),
std_redisuals = residuals/sd(residuals(model))
)
ggplot(monthly, aes(x = realtors, y = revenue)) +
geom_point(aes(color = std_redisuals), size = 3) +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
annotate(geom = "text",
x = 75,
y = 9000,
label = formula ) +
scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
scale_y_continuous(breaks = seq(5000, 12500, 2500),
labels = scales::label_comma()) +
theme_minimal() +
labs(
title = "Monthly revenue vs. Number of Realtors",
subtitle = "Points colored by standardized residuals",
x = "# of Realtors with Business",
y = "Monthly Revenue",
color = "Standardized Residuals"
) +
theme(
plot.title = element_text(size = 16, face = "bold")
)
lm(revenue ~ realtors, ds)
t.test(model)
t.test(revenue ~ realtor, ds)
ds
summary(model)
model
coef(model)
summary(model)
summary(model)$coefficients["realtors", "Pr(>|t|)"]
coef(summary(model))[2,4]
summary(model)$fstatistic
f <- summary(model)$fstatistic
pf(f[1], f[2], f[3], lower.tail = FALSE)
s <- summary(model)
s
p_coef(s)[2,4]
coef(s)[2,4]
p_model <- pf(s$fstatistic[1],
s$fstatistic[2],
s$fstatistic[3],
lower.tail = FALSE)
p_model
plot(model)
new_realtors <- data.frame(realtors = c(130, 140, 150))
predict (model, new_realtors)
intercept <- model$coefficients[1]
slope <- model$coefficients[2]
r2 <- summary(model)$r.squared
r2_rounded <- round(r2, 2)
intercept <- format(model$coefficients[1], digits = 7)
slope <- format(model$coefficients[2], digits = 4)
formula <- glue("y={slope}X + {intercept}\n R^2 = {r2_rounded}")
monthly <- ds %>%
mutate(
residuals = residuals(model),
std_redisuals = residuals/sd(residuals(model))
)
ggplot(monthly, aes(x = realtors, y = revenue)) +
geom_point(aes(color = std_redisuals), size = 3) +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
annotate(geom = "text",
x = 75,
y = 9000,
label = formula ) +
scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
scale_y_continuous(breaks = seq(5000, 12500, 2500),
labels = scales::label_comma()) +
theme_minimal() +
labs(
title = "Monthly revenue vs. Number of Realtors",
subtitle = "Points colored by standardized residuals",
x = "# of Realtors with Business",
y = "Monthly Revenue",
color = "Standardized Residuals"
) +
theme(
plot.title = element_text(size = 16, face = "bold")
)
p_model
p_coef <- coef(s)[2,4]
p_coef
p_value <- round((p_coef), 4)
p_value
formula
# formula <- glue("y={slope}X + {intercept}\n R^2 = {r2_rounted}")
formula <- glue("y={slope}X + {intercept}\n p-value = {p_value}")
formula
monthly <- ds %>%
mutate(
residuals = residuals(model),
std_redisuals = residuals/sd(residuals(model))
)
ggplot(monthly, aes(x = realtors, y = revenue)) +
geom_point(aes(color = std_redisuals), size = 3) +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
annotate(geom = "text",
x = 75,
y = 9000,
label = formula ) +
scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
scale_y_continuous(breaks = seq(5000, 12500, 2500),
labels = scales::label_comma()) +
theme_minimal() +
labs(
title = "Monthly revenue vs. Number of Realtors",
subtitle = "Points colored by standardized residuals",
x = "# of Realtors with Business",
y = "Monthly Revenue",
color = "Standardized Residuals"
) +
theme(
plot.title = element_text(size = 16, face = "bold")
)
ggsave("monthly_revenue_realtors.png")
